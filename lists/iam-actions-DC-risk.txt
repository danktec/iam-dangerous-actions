###############################################################################################################################
##  Version 0.1.1                                                                                                            ##
##  In total: 15 AWS Services, 344 IAM actions, DC security risk                                                             ##   
##                                                                                                                           ## 
##  To-do list for additional services:                                                                                      ##
##  https://github.com/ZiyadAlmbasher/iam-dangerous-actions/issues?q=state%3Aopen%20label%3A%22Services-to-add%22            ##
##                                                                                                                           ##       
##  Risk Label:                                                                                                              ##           
##  DC = Disabling or evasion of Security Controls                                                                           ##   
##                                                                                                                           ##   
##  Note: Direct or primary security risks are not placed in parentheses, whereas indirect or secondary security risks are.  ##
##                                                                                                                           ##
############################################################################################################################### 


"sts:AssumeRole": (DC)
"sts:AssumeRoleWithSAML": (DC)
"sts:AssumeRoleWithWebIdentity": (DC)
"sts:AssumeRoot": (DC)
"sts:GetFederationToken": (DC)
"sts:GetServiceBearerToken": (DC)
"sts:GetSessionToken": (DC)

"iam:AddRoleToInstanceProfile": (DC)
"iam:AttachGroupPolicy": (DC)
"iam:AttachRolePolicy": (DC)
"iam:AttachUserPolicy": (DC)
"iam:ChangePassword": DC
"iam:CreateAccessKey": (DC)
"iam:CreateLoginProfile": (DC) 
"iam:CreateOpenIDConnectProvider": (DC)
"iam:CreatePolicyVersion": (DC)
"iam:CreateSAMLProvider": (DC)
"iam:CreateUser": (DC)
"iam:DeactivateMFADevice": DC  
"iam:DeleteAccessKey": DC
"iam:DeleteAccountPasswordPolicy": DC  
"iam:DeleteCloudFrontPublicKey": DC
"iam:DeleteGroup": DC
"iam:DeleteGroupPolicy": DC 
"iam:DeleteLoginProfile": DC
"iam:DeleteOpenIDConnectProvider": DC
"iam:DeletePolicy": DC 
"iam:DeletePolicyVersion": DC 
"iam:DeleteRole": DC
"iam:DeleteRolePermissionsBoundary": DC 
"iam:DeleteRolePolicy": DC 
"iam:DeleteSAMLProvider": DC
"iam:DeleteSSHPublicKey": DC
"iam:DeleteServerCertificate": DC
"iam:DeleteServiceLinkedRole": DC
"iam:DeleteServiceSpecificCredential": DC
"iam:DeleteSigningCertificate": DC
"iam:DeleteUser": DC
"iam:DeleteUserPermissionsBoundary": DC 
"iam:DeleteUserPolicy": DC 
"iam:DeleteVirtualMFADevice": DC
"iam:DetachGroupPolicy": DC 
"iam:DetachRolePolicy": DC 
"iam:DetachUserPolicy": DC 
"iam:DisableOrganizationsRootCredentialsManagement": DC
"iam:DisableOrganizationsRootSessions": DC
"iam:EnableOrganizationsRootCredentialsManagement": DC 
"iam:EnableOrganizationsRootSessions": DC
"iam:PutGroupPolicy":  (DC)
"iam:PutRolePermissionsBoundary": DC 
"iam:PutRolePolicy": (DC)
"iam:PutUserPermissionsBoundary": DC 
"iam:PutUserPolicy": (DC)
"iam:RemoveClientIDFromOpenIDConnectProvider": DC
"iam:RemoveUserFromGroup": DC 
"iam:ResetServiceSpecificCredential": DC
"iam:SetDefaultPolicyVersion":  (DC)
"iam:SetSTSRegionalEndpointStatus": DC
"iam:SetSecurityTokenServicePreferences": DC
"iam:UpdateAccessKey": DC 
"iam:UpdateAccountEmailAddress":  (DC)
"iam:UpdateAccountPasswordPolicy": DC
"iam:UpdateAssumeRolePolicy":  (DC)
"iam:UpdateCloudFrontPublicKey": DC
"iam:UpdateLoginProfile": DC 
"iam:UpdateOpenIDConnectProviderThumbprint": DC
"iam:UpdateRole": (DC)
"iam:UpdateSAMLProvider": (DC)
"iam:UpdateSSHPublicKey": DC 
"iam:UpdateServerCertificate": DC
"iam:UpdateServiceSpecificCredential": DC
"iam:UpdateSigningCertificate": DC
"iam:UpdateUser": (DC)
"iam:UploadCloudFrontPublicKey": DC
"iam:UploadServerCertificate": DC
"iam:UploadSigningCertificate": DC

"organizations:AcceptHandshake": (DC)
"organizations:AttachPolicy": (DC)
"organizations:CancelHandshake": DC
"organizations:CreateAccount": (DC)
"organizations:CreateGovCloudAccount": (DC)
"organizations:CreateOrganization": (DC)
"organizations:CreateOrganizationalUnit": (DC)
"organizations:CreatePolicy": DC 
"organizations:DeleteOrganization": DC
"organizations:DeleteOrganizationalUnit": DC
"organizations:DeletePolicy": DC
"organizations:DeleteResourcePolicy": DC
"organizations:DeregisterDelegatedAdministrator": DC
"organizations:DetachPolicy": DC
"organizations:DisableAWSServiceAccess": DC
"organizations:DisablePolicyType": DC
"organizations:EnableAllFeatures": (DC)
"organizations:EnablePolicyType": (DC)
"organizations:InviteAccountToOrganization": (DC)
"organizations:LeaveOrganization": (DC)
"organizations:MoveAccount": (DC)
"organizations:PutResourcePolicy": DC 
"organizations:RegisterDelegatedAdministrator": (DC)
"organizations:RemoveAccountFromOrganization": (DC)
"organizations:UpdateOrganizationalUnit": DC
"organizations:UpdatePolicy": DC 

"sso:AttachManagedPolicyToPermissionSet":  (DC)
"sso:CreateAccountAssignment": (DC)
"sso:CreateApplicationInstanceCertificate": DC
"sso:CreateInstanceAccessControlAttributeConfiguration": (DC)
"sso:CreatePermissionSet": (DC)
"sso:CreateTrust": DC
"sso:CreateTrustedTokenIssuer": DC
"sso:DeleteAccountAssignment": DC
"sso:DeleteApplication": DC
"sso:DeleteApplicationAccessScope": DC
"sso:DeleteApplicationAssignment": DC
"sso:DeleteApplicationAuthenticationMethod": DC
"sso:DeleteApplicationGrant": DC
"sso:DeleteApplicationInstance": DC
"sso:DeleteApplicationInstanceCertificate": DC
"sso:DeleteInlinePolicyFromPermissionSet": DC
"sso:DeleteInstance": DC
"sso:DeleteInstanceAccessControlAttributeConfiguration": DC
"sso:DeleteManagedApplicationInstance": DC
"sso:DeletePermissionSet": DC
"sso:DeletePermissionsBoundaryFromPermissionSet": (DC)
"sso:DeletePermissionsPolicy": DC
"sso:DeleteProfile": DC
"sso:DeleteTrustedTokenIssuer": DC
"sso:DetachCustomerManagedPolicyReferenceFromPermissionSet": DC
"sso:DetachManagedPolicyFromPermissionSet": DC
"sso:DisassociateDirectory": DC
"sso:DisassociateProfile": DC
"sso:ImportApplicationInstanceServiceProviderMetadata": DC
"sso:ProvisionPermissionSet": (DC)
"sso:PutApplicationAccessScope": (DC)
"sso:PutApplicationAssignmentConfiguration": DC 
"sso:PutApplicationAuthenticationMethod": DC
"sso:PutApplicationGrant": (DC)
"sso:PutInlinePolicyToPermissionSet": (DC)
"sso:PutMfaDeviceManagementForDirectory": DC
"sso:PutPermissionsBoundaryToPermissionSet": DC 
"sso:PutPermissionsPolicy": (DC)
"sso:UpdateApplication": (DC)
"sso:UpdateApplicationInstanceActiveCertificate": DC
"sso:UpdateApplicationInstanceResponseConfiguration": (DC)
"sso:UpdateApplicationInstanceResponseSchemaConfiguration": DC
"sso:UpdateApplicationInstanceSecurityConfiguration": DC
"sso:UpdateApplicationInstanceServiceProviderConfiguration": DC
"sso:UpdateApplicationInstanceStatus": DC
"sso:UpdateDirectoryAssociation": (DC)
"sso:UpdateInstanceAccessControlAttributeConfiguration": (DC)
"sso:UpdateManagedApplicationInstanceStatus": DC
"sso:UpdatePermissionSet": DC 
"sso:UpdateProfile": DC
"sso:UpdateSSOConfiguration": (DC)
"sso:UpdateTrust": DC
"sso:UpdateTrustedTokenIssuer": DC

"sso-directory:CompleteVirtualMfaDeviceRegistration": DC
"sso-directory:CompleteWebAuthnDeviceRegistration": DC
"sso-directory:CreateBearerToken": (DC)
"sso-directory:CreateExternalIdPConfigurationForDirectory": (DC)
"sso-directory:CreateProvisioningTenant": (DC)
"sso-directory:DeleteExternalIdPCertificate": DC
"sso-directory:DeleteExternalIdPConfigurationForDirectory": DC
"sso-directory:DeleteGroup": DC
"sso-directory:DeleteMfaDeviceForUser": DC
"sso-directory:DeleteProvisioningTenant": DC
"sso-directory:DeleteUser": DC
"sso-directory:DisableExternalIdPConfigurationForDirectory": DC
"sso-directory:DisableUser": DC
"sso-directory:EnableExternalIdPConfigurationForDirectory": (DC)
"sso-directory:ImportExternalIdPCertificate": DC
"sso-directory:RemoveMemberFromGroup": DC
"sso-directory:UpdateExternalIdPConfigurationForDirectory": DC
"sso-directory:UpdateMfaDeviceForUser": DC
"sso-directory:UpdateUser": (DC)

"cloudformation:CreateStack": (DC)
"cloudformation:CreateStackSet": (DC)
"cloudformation:DeactivateOrganizationsAccess": DC
"cloudformation:DeleteStack": DC
"cloudformation:DeleteStackSet": DC
"cloudformation:ImportStacksToStackSet": DC
"cloudformation:SetStackPolicy": DC
"cloudformation:UpdateStack": (DC)
"cloudformation:UpdateStackSet": (DC)

"lambda:AddLayerVersionPermission": DC
"lambda:AddPermission": (DC)
"lambda:CreateCodeSigningConfig": DC
"lambda:CreateFunctionUrlConfig": DC 
"lambda:DeleteCodeSigningConfig": DC
"lambda:DeleteFunctionCodeSigningConfig": DC
"lambda:DeleteFunctionUrlConfig": DC
"lambda:DeleteLayerVersion": DC  
"lambda:PublishLayerVersion": DC  
"lambda:PutFunctionCodeSigningConfig": DC
"lambda:PutFunctionEventInvokeConfig": DC
"lambda:PutFunctionRecursionConfig": DC
"lambda:RemoveLayerVersionPermission": DC
"lambda:RemovePermission": DC
"lambda:UpdateCodeSigningConfig": DC
"lambda:UpdateFunctionCode": (DC)
"lambda:UpdateFunctionCodeSigningConfig": DC
"lambda:UpdateFunctionConfiguration": DC
"lambda:UpdateFunctionEventInvokeConfig": DC
"lambda:UpdateFunctionUrlConfig": DC 

"config:DeleteAggregationAuthorization": DC
"config:DeleteConfigRule": DC
"config:DeleteConfigurationAggregator": DC
"config:DeleteConfigurationRecorder": DC
"config:DeleteDeliveryChannel": DC
"config:DeleteOrganizationConfigRule": DC
"config:DeletePendingAggregationRequest": DC
"config:DeleteRemediationConfiguration": DC
"config:DeleteRemediationExceptions": DC
"config:DeleteServiceLinkedConfigurationRecorder": DC
"config:PutConfigRule": (DC)
"config:PutConfigurationAggregator": DC
"config:PutConfigurationRecorder": DC
"config:PutDeliveryChannel": DC
"config:PutOrganizationConfigRule": (DC)
"config:PutRemediationConfigurations": DC 
"config:PutRetentionConfiguration": DC 
"config:StopConfigurationRecorder": DC

"s3:BypassGovernanceRetention": DC 
"s3:CreateJob": (DC)
"s3:DeleteAccessGrant": DC
"s3:DeleteAccessGrantsInstance": DC
"s3:DeleteAccessGrantsInstanceResourcePolicy": DC
"s3:DeleteAccessGrantsLocation": DC
"s3:DeleteAccessPoint": DC
"s3:DeleteAccessPointPolicy": DC
"s3:DeleteAccessPointPolicyForObjectLambda": DC
"s3:DeleteBucket": DC 
"s3:DeleteBucketPolicy": DC
"s3:DeleteBucketWebsite": DC
"s3:DeleteMultiRegionAccessPoint": DC
"s3:DeleteObject": (DC)
"s3:DeleteObjectVersion": (DC)
"s3:DissociateAccessGrantsIdentityCenter": DC
"s3:InitiateReplication": (DC)
"s3:ObjectOwnerOverrideToBucketOwner": DC 
"s3:PutAccessGrantsInstanceResourcePolicy": DC
"s3:PutAccessPointConfigurationForObjectLambda": (DC)
"s3:PutAccessPointPolicy": DC 
"s3:PutAccessPointPolicyForObjectLambda": (DC)
"s3:PutAccessPointPublicAccessBlock": DC
"s3:PutAccountPublicAccessBlock": DC
"s3:PutBucketAcl": DC 
"s3:PutBucketCORS": DC 
"s3:PutBucketLogging": DC 
"s3:PutBucketObjectLockConfiguration": DC
"s3:PutBucketOwnershipControls": DC
"s3:PutBucketPolicy": (DC)
"s3:PutBucketPublicAccessBlock": DC 
"s3:PutBucketVersioning": DC 
"s3:PutBucketWebsite": (DC)
"s3:PutEncryptionConfiguration": DC
"s3:PutMultiRegionAccessPointPolicy": (DC)
"s3:PutObject": (DC)
"s3:PutObjectAcl": (DC)
"s3:PutObjectLegalHold": DC
"s3:PutObjectVersionAcl": (DC)
"s3:ReplicateDelete": (DC)
"s3:UpdateAccessGrantsLocation": DC

"s3tables:DeleteNamespace": DC 
"s3tables:DeleteTable": DC 
"s3tables:DeleteTableBucket": DC 
"s3tables:DeleteTableBucketEncryption": DC
"s3tables:DeleteTableBucketPolicy": DC 
"s3tables:DeleteTablePolicy": DC
"s3tables:PutTableBucketEncryption": DC
"s3tables:PutTableBucketPolicy": DC 
"s3tables:PutTableEncryption": DC 
"s3tables:PutTablePolicy": DC 

"cloudfront:AssociateDistributionTenantWebACL": DC
"cloudfront:AssociateDistributionWebACL": DC 
"cloudfront:CreateDistribution": DC 
"cloudfront:CreateFunction": DC  
"cloudfront:CreateKeyGroup": DC
"cloudfront:CreateKeyValueStore": DC
"cloudfront:CreateOriginAccessControl": DC 
"cloudfront:CreateVpcOrigin": DC
"cloudfront:DeleteCloudFrontOriginAccessIdentity": DC 
"cloudfront:DeleteDistribution": DC
"cloudfront:DeleteFieldLevelEncryptionConfig": DC 
"cloudfront:DeleteFieldLevelEncryptionProfile": DC
"cloudfront:DeleteFunction": DC
"cloudfront:DeleteKeyGroup": DC
"cloudfront:DeleteKeyValueStore": DC 
"cloudfront:DeleteOriginAccessControl": DC 
"cloudfront:DeletePublicKey": DC
"cloudfront:DeleteRealtimeLogConfig": DC  
"cloudfront:DisassociateDistributionTenantWebACL": DC 
"cloudfront:DisassociateDistributionWebACL": DC 
"cloudfront:PublishFunction": DC  
"cloudfront:UpdateCloudFrontOriginAccessIdentity": DC 
"cloudfront:UpdateConnectionGroup": DC
"cloudfront:UpdateDistribution": DC  
"cloudfront:UpdateDistributionTenant": DC
"cloudfront:UpdateDomainAssociation": DC
"cloudfront:UpdateFieldLevelEncryptionConfig": DC 
"cloudfront:UpdateFunction": DC  
"cloudfront:UpdateOriginAccessControl": DC 
"cloudfront:UpdateOriginRequestPolicy": DC
"cloudfront:UpdatePublicKey": DC 
"cloudfront:UpdateRealtimeLogConfig": DC 
"cloudfront:UpdateResponseHeadersPolicy": DC

"securityhub:BatchDeleteAutomationRules": DC
"securityhub:BatchDisableStandards": DC
"securityhub:DeleteActionTarget": DC
"securityhub:DeleteAggregatorV2": DC
"securityhub:DeleteAutomationRuleV2": DC
"securityhub:DeleteConfigurationPolicy": DC
"securityhub:DeleteConnectorV2": DC
"securityhub:DeleteMembers": DC
"securityhub:DisableImportFindingsForProduct": DC
"securityhub:DisableOrganizationAdminAccount": DC
"securityhub:DisableSecurityHub": DC
"securityhub:DisableSecurityHubV2": DC
"securityhub:DisassociateFromAdministratorAccount": DC
"securityhub:DisassociateFromMasterAccount": DC
"securityhub:DisassociateMembers": DC
"securityhub:EnableOrganizationAdminAccount":  DC 
"securityhub:UpdateFindingAggregator": DC
"securityhub:UpdateOrganizationConfiguration": DC
"securityhub:UpdateSecurityControl": DC
"securityhub:UpdateSecurityHubConfiguration": DC
"securityhub:UpdateStandardsControl": DC

"route53:AssociateVPCWithHostedZone": DC
"route53:CreateTrafficPolicy": DC
"route53:CreateTrafficPolicyInstance": DC
"route53:CreateTrafficPolicyVersion": DC
"route53:DeactivateKeySigningKey": DC
"route53:DeleteHostedZone": DC
"route53:DeleteReusableDelegationSet": DC
"route53:DeleteTrafficPolicy": DC
"route53:DeleteTrafficPolicyInstance": DC
"route53:DeleteVPCAssociationAuthorization": DC
"route53:DisableHostedZoneDNSSEC": DC
"route53:DisassociateVPCFromHostedZone": DC

"route53domains:RegisterDomain": DC
"route53domains:RetrieveDomainAuthCode": DC

"kms:DeleteCustomKeyStore": DC
"kms:DeleteImportedKeyMaterial": DC
"kms:ScheduleKeyDeletion": DC
"kms:UpdateCustomKeyStore": DC